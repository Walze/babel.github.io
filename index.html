<html>

<head>
    <meta charset="utf-8">
    <script src="https://code.jquery.com/jquery-3.1.0.min.js"></script>
    <script src="turboid.js"></script>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <style>
        * {
            font-family: sans-serif;
            background: #333;
            color: #eee;
            font-size: 20px;
        }
        
        #calc {
            font-size: 2em;
        }
        
        body {
            width: 1024px;
            margin: 0 auto;
        }
    </style>
</head>

<body class="container">
    <h1 id="calc">Loading...</h1>
    <button onclick="window.history.back()">Back</button>
    <button onclick="reset()">Reload</button>
    <h1 id="numero"></h1>
    <h1 id="esse"></h1>
    <script>
        function fact(n) {
            var rval=1;
            for (var i = 2; i <= n; i++)
                rval = rval * i;
            return rval;
        }

        var palavra = prompt("Palavra");
        var palavraNova = '';
        var checkRepeat = new Array();
        var checkRepeatAll = new Array();
        var contador1 = 0;
        var text = document.getElementById('esse');
        var textN = document.getElementById('numero');
        var contador2 = 0;
        var bool = false;
        var anagramas2 = new Array();
        
        loop.turbo(function() {
            
            var x = Math.floor(Math.random() * palavra.length);
            
            if (checkRepeat.indexOf(x) === -1) {
                palavraNova += palavra[x];
                checkRepeat[contador1] = x;
                contador1++; //
            }
            
            var combinacao = checkRepeat.join('');
            if (contador1 == palavra.length) {
                if ($.inArray(combinacao, checkRepeatAll) == -1) {
                    checkRepeatAll[contador2] = combinacao;
                    contador2++;
                    bool = true;
                }
                checkRepeat = [];
                contador1 = 0;
                if (bool) {
                    anagramas2.push(palavraNova);
                    bool = false;
                }
                palavraNova = '';
            }
            
            var anagramasText = anagramas2.join(' ');
            text.innerHTML = anagramasText;
            textN.innerHTML = 'Count = ' + anagramas2.length;
            
            if (fact(palavra.length) === anagramas2.length) {
                $('#calc').text('Done');
                loop.exit();
            }
        }, 2000);

        function reset() {
            location.reload(true);
        }
        
        var f = [];
    </script>
</body>

</html>